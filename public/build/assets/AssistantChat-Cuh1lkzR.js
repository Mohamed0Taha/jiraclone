import{j as e}from"./index-BgEJ3fxA.js";import{r as x}from"./ProjectReportDialog-DJSS4N_t.js";import{a as re,r as L}from"./app-K9NsoLMf.js";import{S as D,C as oe}from"./SmartToyRounded-abUb5QI1.js";import{c as j}from"./createSvgIcon-BJOZcqxU.js";import{D as te,a as se}from"./DialogContent-DSMMXfBC.js";import{D as ne}from"./DialogTitle-CslrqFxR.js";import{A as W}from"./Avatar-B0qmhRz_.js";import{T as d,k as O}from"./Typography-D7k_4FBJ.js";import{C as u}from"./Chip-21CA6oxg.js";import{I as Y}from"./IconButton-MFFsjt5V.js";import{B as g}from"./Box-DwDErR6p.js";import{S as h}from"./Stack-8UQV77y9.js";import{B as S}from"./Button-awGqnw0r.js";import{T as ae}from"./Tooltip-B2fzUN7_.js";import{D as ie}from"./DialogActions-tu8p45QK.js";import{T as ce}from"./TextField-BZLKsJ9m.js";import{C as de}from"./CircularProgress-RchlJGKc.js";import{a as t}from"./createTheme-C_kE-Qd2.js";import"./DefaultPropsProvider-Bua-nAaA.js";import"./useSlot-CiX-lWvG.js";import"./Paper-PFfIOqkm.js";import"./Fade-DhaX7TN9.js";import"./getReactElementRef-F5A8c8Er.js";import"./index-CaqUbZRR.js";import"./Modal-DIrGbC0Y.js";import"./ownerWindow-XbzhRCTS.js";import"./Portal-DfkSyL9i.js";import"./ButtonBase-Cf3WRSsW.js";import"./isFocusVisible-B8k4qzLc.js";import"./useThemeProps-BWPYVe8w.js";import"./index-Cvm9KgRT.js";import"./useControlled-LNSG5UB_.js";import"./Grow---KOMtVK.js";import"./useSlotProps-5DvMlV7h.js";import"./FormControl-9Ne_wXge.js";import"./isMuiElement-BEUJm6md.js";import"./List-D9XOj4nK.js";import"./debounce-Be36O1Ab.js";const le=j(e.jsx("path",{d:"M9 16.17 5.53 12.7a.996.996 0 0 0-1.41 0c-.39.39-.39 1.02 0 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71c.39-.39.39-1.02 0-1.41a.996.996 0 0 0-1.41 0z"})),pe=j(e.jsx("path",{d:"M15 20H5V7c0-.55-.45-1-1-1s-1 .45-1 1v13c0 1.1.9 2 2 2h10c.55 0 1-.45 1-1s-.45-1-1-1m5-4V4c0-1.1-.9-2-2-2H9c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h9c1.1 0 2-.9 2-2m-2 0H9V4h9z"})),ge=j(e.jsx("path",{d:"M12 7c.55 0 1 .45 1 1v4c0 .55-.45 1-1 1s-1-.45-1-1V8c0-.55.45-1 1-1m-.01-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8m1-3h-2v-2h2z"})),xe=j(e.jsx("path",{d:"M12 5.9c1.16 0 2.1.94 2.1 2.1s-.94 2.1-2.1 2.1S9.9 9.16 9.9 8s.94-2.1 2.1-2.1m0 9c2.97 0 6.1 1.46 6.1 2.1v1.1H5.9V17c0-.64 3.13-2.1 6.1-2.1M12 4C9.79 4 8 5.79 8 8s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m0 9c-2.67 0-8 1.34-8 4v2c0 .55.45 1 1 1h14c.55 0 1-.45 1-1v-2c0-2.66-5.33-4-8-4"})),ue=j(e.jsx("path",{d:"M8 6.82v10.36c0 .79.87 1.27 1.54.84l8.14-5.18c.62-.39.62-1.29 0-1.69L9.54 5.98C8.87 5.55 8 6.03 8 6.82"})),he=j(e.jsx("path",{d:"m3.4 20.4 17.45-7.48c.81-.35.81-1.49 0-1.84L3.4 3.6c-.66-.29-1.39.2-1.39.91L2 9.12c0 .5.37.93.87.99L17 12 2.87 13.88c-.5.07-.87.5-.87 1l.01 4.61c0 .71.73 1.2 1.39.91"})),me=O`
  0% { transform: scale(1); opacity: 1; }
  50% { transform: scale(1.05); opacity: 0.9; }
  100% { transform: scale(1); opacity: 1; }
`,be=O`
  0% { transform: translateY(0px); }
  50% { transform: translateY(-8px); }
  100% { transform: translateY(0px); }
`,o={primary:"#6366F1",secondary:"#22D3EE",success:"#34D399",warning:"#F59E0B",error:"#F87171",info:"#60A5FA",paper:"#FFFFFF"},s={appBg:"linear-gradient(135deg, #1e3a8a, #4f46e5, #7c3aed)",appGlass:t(o.paper,.2),titleBg:`linear-gradient(90deg, ${t(o.primary,.55)}, ${t(o.secondary,.45)})`,ribbonBg:t("#233096",.65),ribbonBorder:t(o.paper,.35),scrollbar:t(o.primary,.55),userBubble:`linear-gradient(135deg, ${t("#ec4899",.9)}, ${t("#8b5cf6",.85)})`,userBubbleBorder:t("#a78bfa",.75),asstBubble:`linear-gradient(135deg, ${t(o.info,.9)}, ${t(o.secondary,.85)})`,asstBubbleBorder:t(o.secondary,.75),stripeUser:"linear-gradient(90deg, #f472b6, #a78bfa)",stripeAsst:`linear-gradient(90deg, ${o.info}, ${o.secondary})`,chipGold:o.warning,chipGoldBg:t(o.warning,.18),chipGoldHover:t(o.warning,.28),sendGradient:`linear-gradient(135deg, ${o.secondary}, ${o.primary})`,sendGradientHover:`linear-gradient(135deg, ${o.primary}, ${o.secondary})`,sendFocusRing:`0 0 0 3px ${t(o.secondary,.35)}`,sendShadow:`0 6px 24px ${t(o.primary,.35)}`,sendShadowHover:`0 10px 28px ${t(o.primary,.5)}`,inputBg:t(o.paper,.2),inputBgHover:t(o.paper,.25),inputBgFocus:t(o.paper,.27),inputRing:`0 0 0 3px ${t("#a78bfa",.35)}`,borderSoft:t(o.paper,.35),snapshotBg:t(o.secondary,.12),snapshotBorder:t(o.secondary,.35),dangerBorder:t(o.error,.85),dangerBg:t(o.error,.15),successBg:t(o.success,.2),successText:o.success,cancelBg:t(o.error,.18),cancelText:o.error};function sr({project:y,open:k,onClose:F}){const{props:fe}=re(),[C,A]=x.useState(""),[f,m]=x.useState([]),[b,v]=x.useState(!1),[G,_]=x.useState([]),[Z,M]=x.useState(null),[B,$]=x.useState(null),T=x.useRef(null),z=x.useRef(null),q=()=>{const r=window.Laravel?.csrfToken||document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||document.querySelector('input[name="_token"]')?.value||"";return console.log("CSRF Token Debug:",{windowLaravel:!!window.Laravel,csrfFromWindow:!!window.Laravel?.csrfToken,metaTag:!!document.querySelector('meta[name="csrf-token"]'),tokenLength:r?.length||0,token:r?`${r.substring(0,10)}...`:"MISSING"}),r||console.error("CSRF token not found - this will cause 419 errors"),r},H=async(r,i)=>{const n=q();if(!n)throw console.error("No CSRF token available, attempting to refresh page"),window.location.reload(),new Error("CSRF token missing - page will refresh");try{const a=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":n,"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(i||{}),credentials:"same-origin"}),l=await a.json().catch(()=>({}));if(!a.ok)throw console.error("API Error:",{status:a.status,statusText:a.statusText,data:l,url:r,token:n?"Present":"Missing"}),a.status===419&&(console.error("CSRF token mismatch (419) - refreshing page"),setTimeout(()=>window.location.reload(),1e3)),new Error(l?.message||`Request failed with status ${a.status}`);return l}catch(a){throw console.error("Fetch error:",a),a}},V=async r=>{const i=await fetch(r,{method:"GET",headers:{Accept:"application/json"},credentials:"same-origin"}),n=await i.json().catch(()=>({}));if(!i.ok)throw new Error(n?.message||"Request failed");return n},U=()=>{const r=`/projects/${y.id}/tasks`;try{L.visit(r,{preserveScroll:!0,preserveState:!1,replace:!0})}catch{window.location.assign(r)}};x.useEffect(()=>{k&&V(`/projects/${y.id}/assistant/suggestions`).then(r=>{Array.isArray(r?.suggestions)&&_(r.suggestions)}).catch(()=>{})},[k,y?.id]),x.useEffect(()=>{if(!k)return;const r=setTimeout(()=>z.current?.focus(),120);return()=>clearTimeout(r)},[k]),x.useEffect(()=>{T.current?.scrollTo({top:T.current.scrollHeight,behavior:"smooth"})},[f]);const N=r=>/^\s*(yes|yep|yeah|confirm|confirmed|ok|okay|go ahead|proceed|do it|please delete|please proceed|sure)\s*!*\s*$/i.test(r||""),X=r=>/^\s*(no|cancel|stop|wait|hold on|nevermind|never mind)\s*!*\s*$/i.test(r||""),E=async(r,i)=>{if(!b){v(!0);try{const n=await H(`/projects/${y.id}/assistant/execute`,{command_data:r});m(a=>{const l=[...a],c=l[i];return c&&(c.executed=!0,c.executionResult=n),l.push({role:"assistant",text:n?.message||"Command executed.",response:n,ts:Date.now()}),l}),$(null),U()}catch(n){m(a=>[...a,{role:"assistant",text:`Execution failed: ${n.message}`,error:!0,response:{type:"error"},ts:Date.now()}])}finally{v(!1)}}},I=async r=>{if(!r||b)return;const i={role:"user",text:r,ts:Date.now()};if(m(n=>[...n,i]),A(""),B&&!B.executed){if(N(r))return E(B.data,B.index);if(X(r)){$(null),m(n=>[...n,{role:"assistant",text:"Cancelled. I won't run that command.",ts:Date.now()}]);return}}v(!0);try{const n={message:r,conversation_history:f.map(c=>({role:c.role,content:c.text}))},a=await H(`/projects/${y.id}/assistant/chat`,n);if(a?.show_overlay){m(c=>[...c,{role:"assistant",text:a?.content||"Upgrade to unlock full AI assistance.",response:a,upgrade:!0,ts:Date.now()}]),v(!1);return}const l={role:"assistant",text:a?.message||a?.content||"",response:a,ts:Date.now()};m(c=>{const R=[...c,l],p=a?.command_data||a?.data;if(a?.requires_confirmation&&p){const w=R.length-1;$({data:p,index:w})}return R})}catch(n){m(a=>[...a,{role:"assistant",text:`Error: ${n.message}`,error:!0,ts:Date.now(),response:{type:"error"}}])}finally{v(!1)}},Q=r=>{$(null),m(i=>{const n=[...i],a=n[r];return a&&(a.cancelled=!0),n.push({role:"assistant",text:"Cancelled. I won't run that command.",ts:Date.now()}),n})},J=r=>I(r),K=async(r,i)=>{try{await navigator.clipboard.writeText(i||""),M(r),setTimeout(()=>M(null),1200)}catch{}};return e.jsxs(te,{open:k,onClose:F,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{borderRadius:3,overflow:"hidden",background:s.appBg,border:"none",boxShadow:"0 30px 60px -12px rgba(31,41,255,0.45)",display:"flex",height:"85vh"}},children:[e.jsxs(ne,{sx:{display:"flex",alignItems:"center",gap:1,pr:6,py:1.25,background:s.titleBg,borderBottom:"1px solid rgba(255,255,255,0.25)",color:"white"},children:[e.jsx(W,{sx:{width:32,height:32,background:`linear-gradient(135deg, ${o.secondary}, ${o.primary})`,boxShadow:"0 0 18px rgba(167,139,250,0.65)",animation:`${me} 2.2s infinite`},children:e.jsx(D,{fontSize:"small"})}),e.jsx(d,{variant:"subtitle1",component:"div",sx:{fontWeight:800,letterSpacing:.15},children:"Project Assistant"}),e.jsx(u,{size:"small",label:y?.name||"Project",sx:{ml:1,fontWeight:800,height:22,background:s.appGlass,color:"white",border:"1px solid rgba(255,255,255,0.5)"}}),e.jsx(Y,{onClick:F,sx:{ml:"auto"},"aria-label":"Close assistant chat",children:e.jsx(oe,{fontSize:"small",sx:{color:"white"}})})]}),e.jsxs(se,{dividers:!0,sx:{display:"flex",flexDirection:"column",gap:1,px:0,py:0,background:"linear-gradient(to bottom, rgba(30,58,138,0.85), rgba(67,56,202,0.85))",overflow:"hidden"},children:[e.jsx(g,{sx:{px:2,py:1.5,position:"sticky",top:0,zIndex:2,background:s.ribbonBg,backdropFilter:"blur(10px)",borderBottom:`1px solid ${s.ribbonBorder}`},children:G.length>0?e.jsxs(h,{direction:"row",spacing:1,sx:{flexWrap:"wrap",rowGap:.75},children:[e.jsx(d,{variant:"caption",component:"span",sx:{fontWeight:800,pr:.5,alignSelf:"center",color:s.chipGold},children:"Quick actions:"}),G.map((r,i)=>e.jsx(u,{onClick:()=>J(r),label:r,clickable:!0,size:"small",sx:{border:`1px solid ${s.chipGold}`,background:s.chipGoldBg,color:s.chipGold,"&:hover":{background:s.chipGoldHover,transform:"translateY(-1px)",boxShadow:"0 3px 10px rgba(255,215,0,0.3)"},transition:"all 0.2s ease",fontWeight:700}},i))]}):e.jsx(d,{variant:"caption",component:"span",sx:{opacity:.9,color:"#e0fbfc",fontWeight:600},children:"Ask for summaries, bulk ops, assignments, or reporting. I'll always request confirmation before executing changes."})}),e.jsxs(g,{ref:T,sx:{px:2,py:1.25,overflowY:"auto",flex:1,"&::-webkit-scrollbar":{width:10},"&::-webkit-scrollbar-thumb":{background:s.scrollbar,borderRadius:10}},children:[f.length===0&&e.jsxs(g,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",textAlign:"center",py:4},children:[e.jsx(g,{sx:{animation:`${be} 3s ease-in-out infinite`,mb:3},children:e.jsx(g,{component:"img",src:"https://media1.giphy.com/media/v1.Y2lkPTc5MGI3NjExNXZ6OXcxajF5aGIxZHB3dm5xdm95aWUzanJtaWljb2Y2M3VvcGY4aCZlcD12MV9pbnRlcm5alf9naWZfYnlfaWQmY3Q9Zw/LHZyixOnHwDDy/giphy.gif",alt:"Thinking...",sx:{height:180,width:180,borderRadius:"50%",border:"3px solid rgba(167,139,250,0.45)",boxShadow:"0 0 36px rgba(99,102,241,0.55)"}})}),e.jsx(d,{variant:"h6",sx:{fontWeight:900,color:"#e0e7ff",mb:1},children:"Project Assistant"}),e.jsx(d,{variant:"body1",sx:{color:"rgba(255,255,255,0.95)",maxWidth:520,mb:2},children:"I'm here to help you manage your project tasks. Try asking me:"}),e.jsxs(h,{direction:"row",spacing:1,flexWrap:"wrap",justifyContent:"center",children:[e.jsx(u,{label:"Delete all overdue tasks",sx:{background:t(o.error,.22),color:o.error,fontWeight:700,mb:1,border:`1px solid ${t(o.error,.45)}`}}),e.jsx(u,{label:"Move Review → Done",sx:{background:t("#a78bfa",.22),color:"#a78bfa",fontWeight:700,mb:1,border:`1px solid ${t("#a78bfa",.45)}`}}),e.jsx(u,{label:"Assign tasks to Alex",sx:{background:t(o.secondary,.22),color:o.secondary,fontWeight:700,mb:1,border:`1px solid ${t(o.secondary,.45)}`}}),e.jsx(u,{label:"How many tasks are done?",sx:{background:s.chipGoldBg,color:s.chipGold,fontWeight:700,mb:1,border:`1px solid ${s.chipGold}`}})]})]}),f.map((r,i)=>{const n=r?.response?.command_data||r?.response?.data,a=!!(r?.response?.requires_confirmation&&n),l=(n&&typeof n.type<"u"?String(n.type):"").toLowerCase(),c=l.includes("delete")||l.includes("destroy")||l.includes("remove"),R=!!r?.response?.ui?.show_snapshot,p=r?.role==="user";return r.upgrade?e.jsx(h,{direction:"row",spacing:1.5,sx:{my:2,justifyContent:"center"},children:e.jsxs(g,{sx:{maxWidth:520,width:"100%",p:3,borderRadius:4,background:"linear-gradient(135deg,rgba(255,255,255,0.12),rgba(255,255,255,0.06))",border:"1px solid rgba(255,255,255,0.35)",backdropFilter:"blur(8px)",textAlign:"center",boxShadow:"0 10px 28px -4px rgba(0,0,0,0.35)"},children:[e.jsx(d,{variant:"subtitle1",sx:{fontWeight:900,color:"#ecfeff",mb:1},children:"Unlock AI Assistant Pro"}),e.jsx(d,{variant:"body2",sx:{color:"rgba(255,255,255,0.9)",mb:2,lineHeight:1.6},children:"Get unlimited smart commands, project insights, summaries and bulk actions. Upgrade now to enable execution and richer responses."}),e.jsxs(h,{direction:{xs:"column",sm:"row"},spacing:1.5,justifyContent:"center",children:[e.jsx(S,{variant:"contained",onClick:()=>L.visit(r?.response?.upgrade_url||"/billing"),sx:{textTransform:"none",fontWeight:800,px:3,background:"linear-gradient(135deg,#6366F1,#4F46E5 55%,#4338CA)",boxShadow:"0 8px 22px rgba(79,70,229,.5)","&:hover":{background:"linear-gradient(135deg,#595CEB,#4841D6 55%,#3B32B8)"}},children:"Upgrade Plan"}),e.jsx(S,{variant:"text",onClick:()=>m(w=>w.filter((P,ee)=>ee!==i)),sx:{textTransform:"none",fontWeight:700,color:"#ecfeff"},children:"Dismiss"})]})]})},i):e.jsxs(h,{direction:"row",spacing:1.5,sx:{my:1.5,alignItems:"flex-start",justifyContent:p?"flex-end":"flex-start"},children:[!p&&e.jsx(W,{sx:{width:36,height:36,mt:.5,background:`linear-gradient(135deg, ${o.info}, ${o.secondary})`,boxShadow:`0 0 16px ${t(o.secondary,.6)}`},children:e.jsx(D,{fontSize:"small"})}),e.jsxs(g,{sx:{maxWidth:"82%",p:1.8,borderRadius:3,background:p?s.userBubble:s.asstBubble,border:p?`1px solid ${s.userBubbleBorder}`:`1px solid ${s.asstBubbleBorder}`,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",...p?{borderTopRightRadius:10,borderBottomLeftRadius:18}:{borderTopLeftRadius:10,borderBottomRightRadius:18},position:"relative",overflow:"hidden","&::before":{content:'""',position:"absolute",top:0,left:0,right:0,height:3,background:p?s.stripeUser:s.stripeAsst}},children:[e.jsxs(h,{direction:"row",alignItems:"center",spacing:1,sx:{mb:.8},children:[e.jsx(d,{variant:"caption",component:"span",sx:{fontWeight:900,color:p?"#fff7ed":"#ecfeff"},children:p?"You":"Assistant"}),e.jsx(d,{variant:"caption",component:"span",sx:{color:"rgba(255,255,255,0.9)"},children:new Date(r?.ts||Date.now()).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),!p&&e.jsx(ae,{title:"Copy message",children:e.jsx(Y,{size:"small",onClick:()=>K(i,r?.text),sx:{ml:"auto"},"aria-label":"Copy assistant message",children:Z===i?e.jsx(le,{fontSize:"small",sx:{color:"#ecfeff"}}):e.jsx(pe,{fontSize:"small",sx:{color:"rgba(255,255,255,0.95)"}})})})]}),e.jsx(d,{variant:"body2",sx:{whiteSpace:"pre-wrap",lineHeight:1.7,color:"white",fontWeight:500},children:r?.text}),a&&e.jsxs(g,{sx:{mt:1.8,p:1.8,borderRadius:2.5,border:`1px dashed ${c?s.dangerBorder:t(o.warning,.85)}`,background:c?s.dangerBg:t(o.warning,.15)},children:[e.jsx(d,{variant:"caption",component:"div",sx:{fontWeight:900,display:"block",mb:.8,color:c?"#ff4d6d":s.chipGold},children:c?"⚠️ Delete Preview":"🚀 Command Preview"}),e.jsx(d,{variant:"body2",sx:{mb:1.5,lineHeight:1.6,color:"rgba(255,255,255,0.98)"},children:r?.response?.message}),e.jsxs(h,{direction:"row",spacing:1.5,alignItems:"center",children:[e.jsx(S,{size:"small",variant:"contained",color:c?"error":"primary",startIcon:e.jsx(ue,{}),onClick:()=>E(n,i),disabled:b||r?.executed||r?.cancelled,sx:{textTransform:"none",fontWeight:800,borderRadius:20,px:2,boxShadow:"0 8px 22px rgba(0,0,0,0.3)",background:c?"linear-gradient(135deg, #ff6b6b, #ff8e53)":"linear-gradient(135deg, #34d399, #10b981)","&:hover":{transform:"translateY(-1px) scale(1.03)",boxShadow:"0 10px 26px rgba(0,0,0,0.38)"},transition:"all 0.25s ease"},"aria-label":"Confirm and execute command",children:r?.executed?"Executed":"Confirm"}),e.jsx(S,{size:"small",variant:"outlined",onClick:()=>Q(i),disabled:b||r?.executed||r?.cancelled,sx:{textTransform:"none",borderRadius:20,px:2,borderWidth:1.8,color:"white",borderColor:"rgba(255,255,255,0.6)","&:hover":{background:"rgba(255,255,255,0.15)",borderColor:"rgba(255,255,255,0.9)"}},"aria-label":"Cancel command",children:"Cancel"}),r?.executed&&e.jsx(u,{size:"small",label:"✅ Done",sx:{ml:.5,fontWeight:800,background:s.successBg,color:s.successText,border:`1px solid ${t(o.success,.5)}`}}),r?.cancelled&&e.jsx(u,{size:"small",label:"❌ Cancelled",sx:{ml:.5,fontWeight:800,background:s.cancelBg,color:s.cancelText,border:`1px solid ${t(o.error,.45)}`}})]})]}),r?.response?.type==="information"&&R&&r?.response?.data&&e.jsxs(g,{sx:{mt:1.8,p:1.8,borderRadius:2.5,background:s.snapshotBg,border:`1px solid ${s.snapshotBorder}`},children:[e.jsx(d,{variant:"caption",component:"div",sx:{fontWeight:900,display:"block",mb:1,color:"#67e8f9"},children:"📊 Project Snapshot"}),e.jsxs(h,{direction:"row",spacing:1.5,flexWrap:"wrap",rowGap:1,children:[e.jsx(u,{size:"small",label:`Total: ${r?.response?.data?.tasks?.total??0}`,sx:{fontWeight:800,background:t("#a78bfa",.22),color:"#a78bfa",border:`1px solid ${t("#a78bfa",.45)}`}}),r?.response?.data?.tasks?.by_status&&Object.entries(r.response.data.tasks.by_status).map(([w,P])=>e.jsx(u,{size:"small",label:`${w}: ${P}`,sx:{fontWeight:800,background:t(o.secondary,.22),color:o.secondary,border:`1px solid ${t(o.secondary,.45)}`}},w)),typeof r?.response?.data?.tasks?.overdue=="number"&&e.jsx(u,{size:"small",label:`⚠️ Overdue: ${r.response.data.tasks.overdue}`,sx:{fontWeight:800,background:t(o.error,.22),color:o.error,border:`1px solid ${t(o.error,.45)}`}})]})]}),r?.error&&e.jsxs(h,{direction:"row",alignItems:"center",spacing:.75,sx:{mt:1.5},children:[e.jsx(ge,{fontSize:"small",sx:{color:"#ff4d6d"}}),e.jsx(d,{variant:"caption",component:"span",sx:{color:"#ff4d6d",fontWeight:600},children:"Something went wrong. Please adjust and try again."})]})]}),p&&e.jsx(W,{sx:{width:36,height:36,mt:.5,background:"linear-gradient(135deg, #f472b6, #a78bfa)",boxShadow:"0 0 16px rgba(244,114,182,0.55)"},children:e.jsx(xe,{fontSize:"small"})})]},i)}),b&&f.length>0&&f[f.length-1].role==="user"&&e.jsxs(h,{direction:"row",spacing:1.5,sx:{my:1.5,alignItems:"flex-start"},children:[e.jsx(W,{sx:{width:36,height:36,mt:.5,background:`linear-gradient(135deg, ${o.info}, ${o.secondary})`,boxShadow:`0 0 16px ${t(o.secondary,.6)}`},children:e.jsx(D,{fontSize:"small"})}),e.jsxs(g,{sx:{p:1.8,borderRadius:3,background:s.asstBubble,border:`1px solid ${s.asstBubbleBorder}`,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",borderTopLeftRadius:10,borderBottomRightRadius:18,maxWidth:320,position:"relative",overflow:"hidden","&::before":{content:'""',position:"absolute",top:0,left:0,right:0,height:3,background:s.stripeAsst}},children:[e.jsxs(h,{direction:"row",alignItems:"center",spacing:1,sx:{mb:.5},children:[e.jsx(d,{variant:"caption",component:"span",sx:{fontWeight:900,color:"#ecfeff"},children:"Assistant"}),e.jsx(d,{variant:"caption",component:"span",sx:{color:"rgba(255,255,255,0.95)"},children:new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),e.jsxs(g,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(g,{component:"img",src:"https://media1.giphy.com/media/v1.Y2lkPTc5MGI3NjExNXZ6OXcxajF5aGIxZHB3dm5xdm95aWUzanJtaWljb2Y2M3VvcGY4aCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/LHZyixOnHwDDy/giphy.gif",alt:"Thinking...",sx:{height:60,width:60,borderRadius:1.5,mr:1.5,border:"1px solid rgba(255,255,255,0.4)"}}),e.jsx(d,{variant:"body2",sx:{fontWeight:700,color:"#ecfeff"},children:"Thinking..."})]})]})]})]})]}),e.jsxs(ie,{sx:{px:2,py:1.5,borderTop:`1px solid ${s.ribbonBorder}`,background:s.ribbonBg,backdropFilter:"blur(10px)",position:"sticky",bottom:0,zIndex:2},children:[e.jsx(ce,{inputRef:z,fullWidth:!0,size:"small",placeholder:"Type your message...",value:C,onChange:r=>A(r.target.value),onKeyDown:r=>{r.key==="Enter"&&!r.shiftKey&&(r.preventDefault(),I(C.trim()))},sx:{"& .MuiOutlinedInput-root":{borderRadius:24,backgroundColor:s.inputBg,"&:hover":{backgroundColor:s.inputBgHover},"&.Mui-focused":{backgroundColor:s.inputBgFocus,boxShadow:s.inputRing}},"& .MuiOutlinedInput-input":{py:1.25,px:2,color:"white",fontWeight:500,"&::placeholder":{color:"rgba(255,255,255,0.85)"}},"& .MuiOutlinedInput-notchedOutline":{borderColor:s.borderSoft,borderWidth:1.8}}}),e.jsx(S,{onClick:()=>I(C.trim()),disabled:!C.trim()||b,variant:"contained",sx:{textTransform:"none",fontWeight:900,borderRadius:24,px:2.8,minWidth:112,height:42,background:s.sendGradient,color:"#ffffff",boxShadow:s.sendShadow,"&:hover":{boxShadow:s.sendShadowHover,transform:"translateY(-1px) scale(1.03)",background:s.sendGradientHover},"&.Mui-focusVisible":{boxShadow:`${s.sendShadow}, ${s.sendFocusRing}`},"&.Mui-disabled":{background:`linear-gradient(135deg, ${t(o.secondary,.45)}, ${t(o.primary,.45)})`,color:"rgba(255,255,255,0.85)"},transition:"all 0.25s ease"},startIcon:b?null:e.jsx(he,{}),"aria-label":"Send message",children:b?e.jsx(de,{size:20,sx:{color:"#fff"}}):"Send"})]})]})}export{sr as default};
