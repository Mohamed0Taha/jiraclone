import{j as t}from"./index-BgEJ3fxA.js";import{r as B}from"./ProjectReportDialog-DJSS4N_t.js";import{E}from"./Edit-KFQoxZFW.js";import{D as F}from"./Delete-hxgZVV99.js";import{V as N}from"./Visibility-DofpzXGt.js";import{C as k}from"./CalendarMonthRounded-D2pw7wm1.js";import{c as C}from"./createSvgIcon-BJOZcqxU.js";import{F as O}from"./FlagRounded-B2nmnq5y.js";import{P as U,C as W,I as Y}from"./ImageModal-D8IPxvIn.js";import{u as X,T as n}from"./Typography-D7k_4FBJ.js";import{T as c}from"./Tooltip-B2fzUN7_.js";import{C as q}from"./Card-f4gJA82V.js";import{B as m}from"./Box-DwDErR6p.js";import{C as G}from"./CardContent-Bdo1cAqR.js";import{I as j}from"./IconButton-MFFsjt5V.js";import{S as w}from"./Stack-8UQV77y9.js";import{C as z}from"./Chip-21CA6oxg.js";import{a as h}from"./createTheme-C_kE-Qd2.js";import"./DefaultPropsProvider-Bua-nAaA.js";import"./Close-CE36E4Lb.js";import"./DialogContent-DSMMXfBC.js";import"./useSlot-CiX-lWvG.js";import"./Paper-PFfIOqkm.js";import"./Fade-DhaX7TN9.js";import"./getReactElementRef-F5A8c8Er.js";import"./index-CaqUbZRR.js";import"./Modal-DIrGbC0Y.js";import"./ownerWindow-XbzhRCTS.js";import"./Portal-DfkSyL9i.js";import"./index-Cvm9KgRT.js";import"./useControlled-LNSG5UB_.js";import"./Grow---KOMtVK.js";import"./useSlotProps-5DvMlV7h.js";import"./isFocusVisible-B8k4qzLc.js";import"./ButtonBase-Cf3WRSsW.js";import"./CircularProgress-RchlJGKc.js";import"./useThemeProps-BWPYVe8w.js";const J=C(t.jsx("path",{d:"M19 7v2.99s-1.99.01-2 0V7h-3s.01-1.99 0-2h3V2h2v3h3v2zm-3 4V8h-3V5H5c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-8zM5 19l3-4 2 3 3-4 4 5z"})),K=C(t.jsx("path",{d:"M16.01 11H5c-.55 0-1 .45-1 1s.45 1 1 1h11.01v1.79c0 .45.54.67.85.35l2.78-2.79c.19-.2.19-.51 0-.71l-2.78-2.79c-.31-.32-.85-.09-.85.35z"})),Q=C(t.jsx("path",{d:"M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2M8.5 13.5l2.5 3.01L14.5 12l4.5 6H5z"}));function Le({task:i,onEdit:$,onDelete:V,onClick:s,onImageUpload:M,accent:S}){const l=X(),I=l.palette.primary.main,[A,T]=B.useState(!1),u=e=>{e.preventDefault(),e.stopPropagation()},y=e=>{if(!e)return null;const r=new Date(e);return Number.isNaN(r.getTime())?null:r},D=e=>{const r=typeof e=="string"?y(e):e;return r?r.toLocaleDateString(void 0,{month:"short",day:"numeric"}):"â€”"},L=e=>{switch(e){case"urgent":return l.palette.error.main;case"high":return l.palette.warning.main;case"medium":return l.palette.info.main;case"low":return l.palette.success.main;default:return l.palette.info.main}},P=e=>{switch(e){case"urgent":return"Urgent";case"high":return"High";case"medium":return"Medium";case"low":return"Low";default:return"Medium"}},x=y(i?.start_date),g=y(i?.end_date),R=new Date,v=e=>e?new Date(e.getFullYear(),e.getMonth(),e.getDate()):null,f=v(x),d=v(g),_=v(R);let b=null,o=null;if(f&&d&&d>f){const e=d.getTime()-f.getTime();o=Math.max(0,_.getTime()-f.getTime())/e*100,b=Math.round(Math.min(100,o))}const p=!!(d&&_>d&&i?.status!=="done");let a=S||I;i?.status==="done"?a=e=>e.palette.success.main:o!=null&&(o<=50?a=e=>e.palette.success.main:o<=75?a=e=>e.palette.info.main:o<=90?a=e=>e.palette.warning.main:o<=100?a=e=>e.palette.warning.dark:a=e=>e.palette.error.main),p&&(a=e=>e.palette.error.main);const H=(()=>{if(i?.status==="done")return"Task completed";if(o==null)return"No schedule data";const e=`${Math.round(o)}% of scheduled time elapsed`;return p?e+" (overdue)":o>100?e+" (time fully consumed)":e})();return t.jsxs(t.Fragment,{children:[t.jsx(c,{title:s?"Click to view task details and comments":"",placement:"top",disableHoverListener:!s,children:t.jsxs(q,{variant:"outlined",onClick:s,sx:{borderLeft:`4px solid ${S||I}`,borderRadius:2,overflow:"hidden",background:e=>h(e.palette.background.paper,.98),cursor:s?"pointer":"default",transition:"transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out","&:hover":s?{transform:"translateY(-2px)",boxShadow:l.shadows[4]}:{}},children:[i?.cover_image&&t.jsx(m,{sx:{width:"100%",aspectRatio:"16 / 9",overflow:"hidden",backgroundColor:"grey.100",borderBottom:"1px solid",borderColor:"divider",cursor:"pointer",position:"relative","&:hover":{"&::after":{content:'""',position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.1)",transition:"background-color 0.2s"}}},onClick:e=>{u(e),T(!0)},children:t.jsx("img",{src:i.cover_image,alt:i.title||"Task image",style:{width:"100%",height:"100%",objectFit:"cover",display:"block"},loading:"lazy"})}),t.jsxs(G,{sx:{p:1.25},children:[t.jsxs(m,{sx:{display:"flex",alignItems:"flex-start",gap:1,mb:i?.description||x||g||i?.milestone?.75:.25},children:[t.jsxs(m,{sx:{flex:1,minWidth:0},children:[i?.id&&t.jsxs(n,{variant:"caption",sx:{display:"block",fontWeight:600,letterSpacing:.5,lineHeight:1.1,mb:.25,color:"primary.main"},title:`Task ID: ${i.id}`,children:["#",i.id]}),t.jsx(n,{variant:"subtitle2",fontWeight:700,sx:{lineHeight:1.25,display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",wordBreak:"break-word"},title:i?.title||"(Untitled)",children:i?.title||"(Untitled)"})]}),t.jsxs(m,{sx:{display:"flex",alignItems:"center",gap:.5,flexShrink:0},children:[t.jsx(c,{title:"View Details",children:t.jsx(j,{size:"small",onClick:e=>{u(e),s?.()},"aria-label":"View task details",children:t.jsx(N,{fontSize:"small"})})}),t.jsx(c,{title:"Edit",children:t.jsx(j,{size:"small",onClick:e=>{u(e),$?.()},"aria-label":"Edit task",children:t.jsx(E,{fontSize:"small"})})}),M&&t.jsx(c,{title:"Add Image",children:t.jsxs(j,{size:"small",component:"label","aria-label":"Add image",onClick:e=>e.stopPropagation(),children:[t.jsx(J,{fontSize:"small"}),t.jsx("input",{hidden:!0,type:"file",accept:"image/*",onChange:e=>{const r=e.target.files?.[0];r&&(M?.(r),e.target.value="")}})]})}),t.jsx(c,{title:"Delete",children:t.jsx(j,{size:"small",onClick:e=>{u(e),V?.()},"aria-label":"Delete task",children:t.jsx(F,{fontSize:"small"})})})]})]}),i?.milestone&&t.jsxs(w,{direction:"row",spacing:.5,sx:{mb:.5},alignItems:"center",children:[t.jsx(O,{fontSize:"inherit",style:{fontSize:14},sx:{color:e=>e.palette.warning.main}}),t.jsx(n,{variant:"caption",sx:{fontWeight:600,color:e=>e.palette.warning.main},children:"Milestone"})]}),t.jsxs(w,{direction:"row",spacing:1,sx:{mb:.75},alignItems:"center",children:[t.jsx(z,{label:P(i?.priority),size:"small",icon:i?.priority==="urgent"?t.jsx(U,{style:{fontSize:14}}):void 0,sx:{height:20,fontSize:"0.7rem",fontWeight:600,backgroundColor:L(i?.priority),color:"white","& .MuiChip-icon":{color:"white"}}}),i?.comments_count>0&&t.jsx(z,{label:`${i.comments_count} ${i.comments_count===1?"comment":"comments"}`,size:"small",icon:t.jsx(W,{style:{fontSize:14}}),sx:{height:20,fontSize:"0.7rem",fontWeight:600,backgroundColor:"primary.main",color:"white","& .MuiChip-icon":{color:"white"}}}),i?.attachments_count>0&&t.jsx(z,{label:`${i.attachments_count}`,size:"small",icon:t.jsx(Q,{style:{fontSize:14}}),sx:{height:20,fontSize:"0.7rem",fontWeight:600,backgroundColor:"secondary.main",color:"white","& .MuiChip-icon":{color:"white"}}}),(!i?.comments_count||i.comments_count===0)&&s&&t.jsxs(w,{direction:"row",spacing:.25,alignItems:"center",children:[t.jsx(W,{style:{fontSize:14},sx:{color:"text.secondary"}}),t.jsx(n,{variant:"caption",color:"text.secondary",children:"Click to add comments"})]})]}),i?.description&&t.jsx(n,{variant:"body2",color:"text.secondary",sx:{mb:.75,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:i.description}),(x||g)&&t.jsxs(w,{direction:"row",spacing:.5,alignItems:"center",sx:{mb:b!==null?.6:.2,minHeight:20},children:[t.jsx(k,{fontSize:"inherit",style:{fontSize:16},sx:{color:e=>h(e.palette.text.primary,.66)}}),t.jsx(n,{variant:"caption",color:"text.secondary",children:D(x)}),t.jsx(K,{fontSize:"inherit",style:{fontSize:16},sx:{color:e=>h(e.palette.text.primary,.5)}}),t.jsx(c,{title:p?"Task is overdue":"",disableHoverListener:!p,children:t.jsx(n,{variant:"caption",sx:{fontWeight:600,color:e=>p?e.palette.error.main:e.palette.text.secondary},children:D(g)})})]}),b!==null&&t.jsx(c,{title:H,placement:"top",arrow:!0,children:t.jsxs(m,{sx:{position:"relative",height:8,borderRadius:4,overflow:"hidden",background:e=>h(e.palette.text.disabled,.15),mb:.75},"aria-label":H,children:[t.jsx(m,{sx:{position:"absolute",inset:0,width:`${b}%`,height:"100%",background:a,transition:"width .25s ease, background-color .25s ease"}}),o!=null&&o<=100&&t.jsx(m,{sx:{position:"absolute",top:0,bottom:0,left:`${Math.min(100,Math.max(0,o))}%`,width:2,transform:"translateX(-1px)",background:e=>h(e.palette.common.black,.25)}})]})}),i?.creator?.name&&t.jsxs(n,{variant:"caption",color:"text.secondary",display:"block",children:["Created by ",i.creator.name]}),i?.assignee?.name&&t.jsxs(n,{variant:"caption",color:"text.secondary",display:"block",children:["Assigned to ",i.assignee.name]})]})]})}),t.jsx(Y,{open:A,onClose:()=>T(!1),src:i?.cover_image,alt:i?.title||"Task image",title:`Task #${i?.id}: ${i?.title}`,downloadUrl:i?.cover_image})]})}export{Le as default};
