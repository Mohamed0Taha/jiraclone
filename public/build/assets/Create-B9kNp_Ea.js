const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CreateStepBasics-BZ0v5Qgr.js","assets/index-BgEJ3fxA.js","assets/ProjectReportDialog-DJSS4N_t.js","assets/Title-CM3NkCxE.js","assets/createSvgIcon-BJOZcqxU.js","assets/DefaultPropsProvider-Bua-nAaA.js","assets/createTheme-C_kE-Qd2.js","assets/Key-B9enTFzV.js","assets/Stack-8UQV77y9.js","assets/useThemeProps-BWPYVe8w.js","assets/Typography-D7k_4FBJ.js","assets/Box-DwDErR6p.js","assets/TextField-BZLKsJ9m.js","assets/useSlot-CiX-lWvG.js","assets/FormControl-9Ne_wXge.js","assets/isMuiElement-BEUJm6md.js","assets/List-D9XOj4nK.js","assets/ownerWindow-XbzhRCTS.js","assets/getReactElementRef-F5A8c8Er.js","assets/index-CaqUbZRR.js","assets/debounce-Be36O1Ab.js","assets/index-Cvm9KgRT.js","assets/useSlotProps-5DvMlV7h.js","assets/Grow---KOMtVK.js","assets/Modal-DIrGbC0Y.js","assets/Portal-DfkSyL9i.js","assets/Fade-DhaX7TN9.js","assets/Paper-PFfIOqkm.js","assets/useControlled-LNSG5UB_.js","assets/InputAdornment-BMgQdgnP.js","assets/CreateStepScope-gKB_KDES.js","assets/MenuItem-CFfd6fkg.js","assets/ButtonBase-Cf3WRSsW.js","assets/isFocusVisible-B8k4qzLc.js","assets/listItemTextClasses-DfQra0jB.js","assets/dividerClasses-C37mlFxW.js","assets/Slider-BV__jMPm.js","assets/CreateStepObjectives-BfCyGmAt.js","assets/WarningAmber-CV96wkjt.js","assets/CreateStepReview-CExcrzZL.js","assets/Alert-AqF1eoq9.js","assets/IconButton-MFFsjt5V.js","assets/CircularProgress-RchlJGKc.js","assets/Divider-Mh942rqT.js","assets/Chip-21CA6oxg.js"])))=>i.map(i=>d[i]);
import{u as be,H as ye,_ as k}from"./app-K9NsoLMf.js";import{j as t}from"./index-BgEJ3fxA.js";import{r}from"./ProjectReportDialog-DJSS4N_t.js";import{A as _e}from"./AuthenticatedLayout-BoAa4njZ.js";import{S as ve}from"./Save-D1sKxa3V.js";import{A as Se}from"./ArrowBack-BADPg0TL.js";import{g as Z,v as ke}from"./CreateFormValidation-CA3y08xH.js";import Ce from"./DocumentUploadStep-BSfs6Uli.js";import{u as we,T as _}from"./Typography-D7k_4FBJ.js";import{B as m}from"./Box-DwDErR6p.js";import{C as ee}from"./Container-CINNDH99.js";import{B as Ee,S as Ae,a as Le,b as Te}from"./Stepper-DLGaimn0.js";import{L as te}from"./Link-Cm4ksNIx.js";import{F as ze}from"./Fade-DhaX7TN9.js";import{P as De}from"./Paper-PFfIOqkm.js";import{L as Pe}from"./LinearProgress-DS1Mq4qD.js";import{S as oe}from"./Stack-8UQV77y9.js";import{B as v}from"./Button-awGqnw0r.js";import{C as Be}from"./CircularProgress-RchlJGKc.js";import{a as i}from"./createTheme-C_kE-Qd2.js";import"./transition-BoHI2LEi.js";import"./CookieConsent-DEMz9Qt1.js";import"./Slide-BpTZt6Xy.js";import"./getReactElementRef-F5A8c8Er.js";import"./index-CaqUbZRR.js";import"./debounce-Be36O1Ab.js";import"./ownerWindow-XbzhRCTS.js";import"./Card-f4gJA82V.js";import"./DefaultPropsProvider-Bua-nAaA.js";import"./createSvgIcon-BJOZcqxU.js";import"./IconButton-MFFsjt5V.js";import"./ButtonBase-Cf3WRSsW.js";import"./isFocusVisible-B8k4qzLc.js";import"./Close-CE36E4Lb.js";import"./csrf-CrwjxjsF.js";import"./CardContent-Bdo1cAqR.js";import"./AutoAwesome-C8YBcAsX.js";import"./Chip-21CA6oxg.js";import"./useSlot-CiX-lWvG.js";import"./Alert-AqF1eoq9.js";import"./useThemeProps-BWPYVe8w.js";import"./useSlotProps-5DvMlV7h.js";import"./index-Cvm9KgRT.js";const Me=r.lazy(()=>k(()=>import("./CreateStepBasics-BZ0v5Qgr.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29]))),Ie=r.lazy(()=>k(()=>import("./CreateStepScope-gKB_KDES.js"),__vite__mapDeps([30,1,2,4,5,6,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,31,32,33,34,35,36]))),Re=r.lazy(()=>k(()=>import("./CreateStepObjectives-BfCyGmAt.js"),__vite__mapDeps([37,1,2,4,5,6,38,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29]))),Ne=r.lazy(()=>k(()=>import("./CreateStepReview-CExcrzZL.js"),__vite__mapDeps([39,1,2,8,5,6,9,10,11,40,13,4,41,32,33,42,27,43,35,44]))),S=()=>t.jsx(m,{sx:{display:"flex",justifyContent:"center",py:4},children:t.jsx(Be,{size:24})});function At({auth:re,projectTypes:C=[],domains:w=[]}){const l=we(),c=["Method","Basics","Scope & Team","Objectives","Review"],[n,p]=r.useState(0),[ae,z]=r.useState(null),[ne,se]=r.useState(null),{data:a,setData:d,post:D,processing:u,errors:ie,reset:P}=be({name:"",key:"",description:"",start_date:"",end_date:"",meta:{project_type:"",domain:"",area:"",location:"",team_size:3,budget:"",primary_stakeholder:"",objectives:"",constraints:""}}),[ce,le]=r.useState({}),B=r.useRef(null);r.useEffect(()=>{B.current?.focus()},[]),r.useEffect(()=>{console.log("Form data changed:",a)},[a]),r.useEffect(()=>{if(!a.name||a.meta.__keyTouched)return;const o=Z(a.name);d("key",o)},[a.name]);const pe=r.useCallback((o,e)=>d("meta",{...a.meta,[o]:e}),[a.meta,d]),g=r.useCallback(o=>ke(o,a,le),[a]),E=r.useCallback(()=>{if(n===0){p(o=>Math.min(c.length-1,o+1));return}g(n)&&p(o=>Math.min(c.length-1,o+1))},[n,g,c.length]),de=r.useCallback(()=>p(o=>Math.max(0,o-1)),[]),me=r.useCallback(o=>{console.log("=== DOCUMENT ANALYSIS DEBUG ==="),console.log("Raw analysis data:",o),console.log("Type:",typeof o),Array.isArray(o)&&console.warn("Analysis data is an array; taking first element.");let e=Array.isArray(o)?o[0]:o;if(e&&typeof e=="object"&&e.data&&typeof e.data=="object"&&(console.log("Unwrapping nested data property."),e=e.data),e&&typeof e=="object"&&e.project&&typeof e.project=="object"&&(console.log("Unwrapping nested project property."),e={...e.project,...e}),!e||typeof e!="object"){console.warn("Analysis data is not an object; aborting population."),p(1);return}const j=e.name||e.project_name||e.title||"",M=e.description||e.summary||e.project_description||"",I=e.objectives||e.goals||e.project_objectives||"",R=e.constraints||e.limitations||"",xe=e.risks||e.project_risks||"",N=e.primary_stakeholder||e.stakeholder||e.client||"";let f=e.project_type||e.type||"",h=e.domain||e.industry||"";const O=e.area||e.focus_area||"",W=e.location||e.site||"",F=e.budget||e.estimated_budget||"",U=e.start_date||e.start||e.project_start||"",H=e.end_date||e.deadline||e.project_end||"",K=e.team_size||e.team||e.estimated_team_size||a.meta.team_size,V=j?Z(j):"";console.log("Normalized fields:",{name:j,projectKey:V,description:M,project_type:f,domain:h,area:O,location:W,team_size:K,budget:F,primary_stakeholder:N,objectives:I,constraints:R,start_date:U,end_date:H}),console.log("Current form data before update:",a);const $=(q,J,Q={})=>{if(!q)return"";let L=String(q).trim();const y=L.toLowerCase();Q[y]&&(L=Q[y]);for(const s of J){const x=(s.value||s).toString(),T=(s.label||s).toString();if(x.toLowerCase()===y||T.toLowerCase()===y)return x}const X=L.replace(/[_-]+/g," ").replace(/\b\w/g,s=>s.toUpperCase());for(const s of J){const x=(s.value||s).toString(),T=(s.label||s).toString();if(x===X||T===X)return x}return""},ge={software:"Software",marketing:"Marketing",design:"Design",research:"Research",construction:"Construction",consulting:"Operations",other:"Operations"},je={healthcare:"Healthcare",finance:"Finance",financial:"Finance",education:"Education",retail:"Retail","e-commerce":"E-commerce",ecommerce:"E-commerce",logistics:"Logistics",manufacturing:"Manufacturing",hospitality:"Hospitality",government:"Government",nonprofit:"Nonprofit",energy:"Energy",telecom:"Telecom",media:"Media",travel:"Travel",saas:"SaaS",agriculture:"Agriculture"},G=$(f,C,ge),Y=$(h,w,je);f=G||f,h=Y||h;const b={...a,name:j||"",key:V,description:M||"",start_date:U||"",end_date:H||"",meta:{...a.meta,project_type:G||f||"",domain:Y||h||"",area:O||"",location:W||"",team_size:K||a.meta.team_size,budget:F||"",primary_stakeholder:N||"",objectives:I||"",constraints:[R,xe].filter(Boolean).join(`
`)}};if(se(o),z("document"),d(b),console.log("New form data after population:",b),console.log("=== END DOCUMENT ANALYSIS DEBUG ==="),!b.name&&!b.description){console.warn("AI did not return name/description; staying on upload step."),window.dispatchEvent(new CustomEvent("project-ai-empty",{detail:{reason:"missing_core_fields"}}));return}p(1)},[d,a,C,w]),ue=r.useCallback(()=>{z("manual"),p(1)},[]),A=r.useCallback(o=>{o.preventDefault(),g(n)&&D("/projects",{onSuccess:()=>{P()}})},[n,g,D,P]);r.useEffect(()=>{const o=e=>{(e.metaKey||e.ctrlKey)&&e.key.toLowerCase()==="s"&&(e.preventDefault(),u||(n<c.length-1?E():A(e)))};return window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[u,n,E,A,c.length]);const fe=`linear-gradient(115deg, ${i(l.palette.primary.main,.85)} 0%, ${i(l.palette.secondary.main,.8)} 60%, ${i(l.palette.primary.dark,.85)} 100%)`,he=()=>{const o={data:a,setData:d,setMeta:pe,errors:ie,localErrors:ce,projectTypes:C,domains:w};switch(n){case 0:return t.jsx(Ce,{onDocumentAnalyzed:me,onManualCreate:ue});case 1:return t.jsx(r.Suspense,{fallback:t.jsx(S,{}),children:t.jsx(Me,{...o,nameRef:B})});case 2:return t.jsx(r.Suspense,{fallback:t.jsx(S,{}),children:t.jsx(Ie,{...o})});case 3:return t.jsx(r.Suspense,{fallback:t.jsx(S,{}),children:t.jsx(Re,{...o})});case 4:return t.jsx(r.Suspense,{fallback:t.jsx(S,{}),children:t.jsx(Ne,{data:a,documentAnalysisData:ne,creationMethod:ae})});default:return null}};return t.jsxs(t.Fragment,{children:[t.jsx(ye,{title:"Create Project"}),t.jsxs(_e,{user:re.user,children:[t.jsxs(m,{sx:{background:fe,color:"#fff",pt:{xs:7,md:9},pb:{xs:8,md:10},position:"relative",overflow:"hidden"},children:[t.jsx(m,{"aria-hidden":!0,sx:{position:"absolute",top:-120,left:-80,width:440,height:440,borderRadius:"50%",background:i("#fff",.12),filter:"blur(90px)"}}),t.jsx(m,{"aria-hidden":!0,sx:{position:"absolute",bottom:-140,right:-120,width:500,height:500,borderRadius:"50%",background:i("#fff",.14),filter:"blur(100px)"}}),t.jsxs(ee,{maxWidth:"md",sx:{position:"relative"},children:[t.jsxs(Ee,{"aria-label":"breadcrumb",sx:{"& a, & .MuiTypography-root":{color:i("#fff",.9),fontSize:14}},children:[t.jsx(te,{underline:"hover",color:"inherit",href:"/dashboard",sx:{fontWeight:500},children:"Dashboard"}),t.jsx(te,{underline:"hover",color:"inherit",href:"/projects",sx:{fontWeight:500},children:"Projects"}),t.jsx(_,{color:"inherit",sx:{fontWeight:600},children:"Create"})]}),t.jsx(_,{variant:"h3",fontWeight:700,sx:{mt:3,letterSpacing:"-0.5px",textShadow:"0 4px 22px rgba(0,0,0,0.25)"},children:"Create a New Project"}),t.jsx(_,{variant:"h6",sx:{mt:2,maxWidth:720,color:i("#fff",.92)},children:"Step through basics, scope, and goals so AI can generate hyper-relevant suggestions later."})]})]}),t.jsx(m,{sx:{bgcolor:"background.default",py:{xs:5,md:8},minHeight:"60vh"},children:t.jsx(ee,{maxWidth:"md",children:t.jsx(ze,{in:!0,timeout:500,children:t.jsxs(De,{elevation:0,sx:{p:{xs:3,sm:5},borderRadius:4,position:"relative",border:`1px solid ${i(l.palette.divider,.7)}`,background:l.palette.mode==="light"?"linear-gradient(145deg,#ffffff,#f8f9fb)":i(l.palette.background.paper,.7),backdropFilter:"blur(6px)",boxShadow:l.palette.mode==="light"?"0 4px 18px -4px rgba(0,0,0,.12)":"0 4px 18px -6px rgba(0,0,0,.7)",overflow:"hidden"},children:[u&&t.jsx(Pe,{sx:{position:"absolute",left:0,top:0,width:"100%",borderTopLeftRadius:16,borderTopRightRadius:16}}),t.jsxs(oe,{direction:"row",alignItems:"center",spacing:1,mb:2,children:[t.jsx(v,{variant:"outlined",size:"small",startIcon:t.jsx(Se,{}),href:"/projects",sx:{textTransform:"none"},children:"Back to Projects"}),t.jsx(_,{variant:"h5",fontWeight:700,children:"Project Setup"})]}),t.jsx(Ae,{activeStep:n,alternativeLabel:!0,sx:{mb:4},children:c.map(o=>t.jsx(Le,{children:t.jsx(Te,{children:o})},o))}),t.jsxs("form",{onSubmit:A,children:[t.jsx(m,{sx:{mb:4,minHeight:400},children:he()}),n>0&&t.jsxs(oe,{direction:"row",spacing:2,justifyContent:"space-between",children:[t.jsx(v,{disabled:n===1,onClick:de,variant:"outlined",sx:{textTransform:"none"},children:"Back"}),n===c.length-1?t.jsx(v,{type:"submit",variant:"contained",disabled:u,startIcon:t.jsx(ve,{}),sx:{textTransform:"none",fontWeight:600},children:u?"Creating...":"Create Project"}):t.jsxs(v,{onClick:E,variant:"contained",sx:{textTransform:"none",fontWeight:600},children:["Next: ",c[n+1]]})]})]})]})})})})]})]})}export{At as default};
